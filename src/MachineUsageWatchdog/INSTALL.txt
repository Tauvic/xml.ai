This project can be used to watch usage of any costly VM. If the CPU is not in use, the Azure
Ubuntu instance where it is running is automatically shut down and deallocated.

The intention is to save money  on unused cloud VMs.

Pre Conditions:
    These settings only apply to Ubuntu based Azure VMs supporting GPU.

VM Configuration Steps:
    Install Azure CLI on the VM by following the steps below.
        https://docs.microsoft.com/en-us/cli/azure/install-azure-cli-apt?view=azure-cli-latest

    Install pip
        sudo apt install python3-pip
    Install python modules for Azure commands on the VM by following the steps below.
        sudo pip install -r requirements.txt

    Enable managed service identity for the VM in question.
        https://docs.microsoft.com/en-us/azure/active-directory/managed-service-identity/tutorial-linux-vm-access-arm

    Grant your VM access/ability to shutdown or reboot itself.
        Go to portal.azure.com and select the VM.
        Click access control(IAM).
        Click Add
            Select the role to "DevTest Labs User".
            Select Assign access to "Virtual Machine".
            Select the Virtual machine applicable.

    To ensure that the machine does not shut itself down when a user is active on command line,
    add following lines to /etc/bash.bashrc
        PROMPT_COMMAND="touch /var/run/MachineUsageWatchdog;$PROMPT_COMMAND"
    This ensures that whenever bash console is used, the shutdown by watchdog is postponed.

    Copy the project folder(MachineUsageWatchdog)
        git clone ssh://prezentium@vs-ssh.visualstudio.com:22/lisa/_ssh/lisa-core
            at an appropriate folder location.
        Ensure that config for the current VM is appropriately programmed in LibLisa/config.py

    Configure for the MachineUsageWatchdog to be run at startup.
        Add following lines to /etc/rc.local

        PATH_TO_REPO=/path/to/repos/lisa-core/
        nohup python3 $PATH_TO_REPO/src/MachineUsageWatchdog/MachineUsageWatchdog.py &

    For processes we want to run in background, install stayAliveForCmd.sh in /usr/local/bin/.
    Also install stayAliveForMinutes.sh in /usr/local/bin/.

Other references
    https://docs.microsoft.com/en-us/azure/azure-stack/azure-stack-create-service-principals
    https://stackoverflow.com/questions/44648067/deallocate-a-ubuntu-vm-from-itself

